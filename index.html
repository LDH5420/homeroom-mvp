<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>담임도구</title>
  <link rel="stylesheet" href="/src/styles/components.css">
  <link rel="stylesheet" href="/src/styles/print-common.css">
</head>
<body>
  <!-- ========== 헤더 ========== -->
  <header class="app-header screen-only">
    <h1>📋 담임도구</h1>
    <div id="class-indicator" class="class-badge"></div>
  </header>

  <div class="app-layout">
    <!-- ========== 좌측 사이드바 (단계 네비) ========== -->
    <aside class="sidebar screen-only">
      <ul class="sidebar-nav">
        <li class="sidebar-item active" data-view="class">
          <span class="step-num">1</span>
          <span>반 설정</span>
        </li>
        <li class="sidebar-item" data-view="students">
          <span class="step-num">2</span>
          <span>학생 목록</span>
        </li>
        <li class="sidebar-item" data-view="print-center">
          <span class="step-num">3</span>
          <span>서식 선택</span>
        </li>
        <li class="sidebar-item" data-view="preview">
          <span class="step-num">4</span>
          <span>인쇄 미리보기</span>
        </li>
      </ul>
    </aside>

    <!-- ========== 우측 메인 영역 ========== -->
    <main class="main-content">

      <!-- ===== 화면 1: 반 설정 ===== -->
      <section id="view-class" class="view" data-view="class">
        <div class="card">
          <div class="card-header">
            <h2>반 설정</h2>
            <button id="btn-add-class" class="btn btn-primary btn-sm">+ 새 반 만들기</button>
          </div>
          <div class="card-body">
            <div id="class-list" class="class-list">
              <div class="empty-state">
                <div class="icon">📁</div>
                <p>등록된 반이 없습니다</p>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ===== 화면 2: 학생 목록 ===== -->
      <section id="view-students" class="view hidden" data-view="students">
        <!-- 붙여넣기 카드 -->
        <div class="card">
          <div class="card-header">
            <h3>명렬 붙여넣기</h3>
          </div>
          <div class="card-body">
            <p class="text-muted mb-md">엑셀/한글에서 복사한 명렬을 붙여넣으세요 (번호+이름 또는 이름만)</p>
            <textarea id="paste-input" class="form-textarea" rows="4" placeholder="1	김민수&#10;2	이서연&#10;3	박준호"></textarea>
            <div class="mt-md">
              <button id="btn-parse-paste" class="btn btn-primary">붙여넣기 적용</button>
            </div>
          </div>
        </div>

        <!-- 학생 테이블 카드 -->
        <div class="card">
          <div class="card-header">
            <h3>학생 명렬</h3>
            <div class="flex gap-sm">
              <button id="btn-clear-students" class="btn btn-ghost btn-sm text-danger">초기화</button>
              <button id="btn-add-student" class="btn btn-secondary btn-sm">+ 학생 추가</button>
            </div>
          </div>
          <div class="card-body">
            <div class="table-wrap">
              <table class="table" id="student-table">
                <thead>
                  <tr>
                    <th style="width:60px">번호</th>
                    <th>이름</th>
                    <th>메모</th>
                    <th style="width:50px"></th>
                  </tr>
                </thead>
                <tbody id="student-tbody">
                  <tr>
                    <td colspan="4" class="empty-state">학생이 없습니다</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          <div class="card-footer flex justify-between items-center">
            <span class="text-muted" id="student-count">0명</span>
            <button id="btn-go-print" class="btn btn-primary">서식 선택으로 →</button>
          </div>
        </div>
      </section>

      <!-- ===== 화면 3: 서식 선택 ===== -->
      <section id="view-print-center" class="view hidden" data-view="print-center">

        <!-- 학기초 준비 -->
        <div class="card">
          <div class="card-header">
            <div>
              <h2>학기초 준비</h2>
              <p class="text-muted" style="font-size:13px; margin-top:4px">학기 시작 전에 한 번만 준비하면 되는 서식입니다.</p>
            </div>
          </div>
          <div class="card-body">
            <div class="chip-grid">
              <button class="chip" data-template="roster_table_v1">
                <span class="chip-icon">📝</span>
                <span class="chip-label">명렬표</span>
                <span class="chip-desc">학기초 기본 명렬표를 다양한 형식으로 출력합니다.</span>
              </button>
              <button class="chip" data-template="locker_label_v1">
                <span class="chip-icon">🗄️</span>
                <span class="chip-label">사물함 명렬표</span>
                <span class="chip-desc">사물함 칸 수에 맞춰 명렬표를 출력합니다.</span>
              </button>
              <button class="chip" data-template="survey_form_v1">
                <span class="chip-icon">📄</span>
                <span class="chip-label">기초조사서</span>
                <span class="chip-desc">학년별 기초조사서 양식을 인쇄합니다.</span>
              </button>
            </div>
          </div>
        </div>

        <!-- 교실 운영 -->
        <div class="card">
          <div class="card-header">
            <div>
              <h2>교실 운영</h2>
              <p class="text-muted" style="font-size:13px; margin-top:4px">교실에서 수시로 사용하는 운영용 서식입니다.</p>
            </div>
          </div>
          <div class="card-body">
            <div class="chip-grid chip-grid-2">
              <button class="chip" data-template="attendance_label_v1">
                <span class="chip-icon">📋</span>
                <span class="chip-label">출석부 부착용 명렬표</span>
                <span class="chip-desc">출석부 앞표지·부착용 명렬표를 인쇄합니다.</span>
              </button>
              <button class="chip" data-template="seating_chart_v1">
                <span class="chip-icon">🪑</span>
                <span class="chip-label">자리바꾸기</span>
                <span class="chip-desc">좌석 배치를 설정하고 자리표를 인쇄합니다.</span>
              </button>
            </div>
          </div>
        </div>

        <!-- 학급 운영 -->
        <div class="card">
          <div class="card-header">
            <div>
              <h2>학급 운영</h2>
              <p class="text-muted" style="font-size:13px; margin-top:4px">학급 의사결정 및 공동 활동을 위한 서식입니다.</p>
            </div>
          </div>
          <div class="card-body">
            <div class="chip-grid chip-grid-1">
              <button class="chip" data-template="vote_ballot_v1">
                <span class="chip-icon">🗳️</span>
                <span class="chip-label">학급투표</span>
                <span class="chip-desc">투표용지와 개표표를 출력합니다.</span>
              </button>
            </div>
          </div>
        </div>

        <!-- 유틸리티 -->
        <div class="utility-section">
          <button class="btn btn-ghost" data-template="print_test_ruler">
            🛠️ 프린터 보정 테스트
            <span class="text-muted" style="font-size:12px; margin-left:8px">프린터 출력 위치를 미리 확인하고 보정합니다.</span>
          </button>
        </div>
      </section>

      <!-- ===== 화면 4: 인쇄 미리보기 ===== -->
      <section id="view-preview" class="view hidden" data-view="preview">
        <div class="preview-layout">
          <!-- 좌측: 컨트롤 -->
          <div class="preview-controls">
            <div class="card">
              <div class="card-header">
                <h3 id="preview-title">인쇄 미리보기</h3>
              </div>
              <div class="card-body">
                <!-- 템플릿 옵션 -->
                <div id="template-options" class="mb-lg"></div>

                <!-- 오프셋 보정 -->
                <div class="form-group">
                  <label class="form-label">X 오프셋 (mm)</label>
                  <input type="number" id="offset-x" class="form-input" value="0" step="0.5">
                </div>
                <div class="form-group">
                  <label class="form-label">Y 오프셋 (mm)</label>
                  <input type="number" id="offset-y" class="form-input" value="0" step="0.5">
                </div>
                <button id="btn-save-offset" class="btn btn-secondary btn-sm" style="width:100%">보정값 저장</button>
              </div>
              <div class="card-footer">
                <p class="text-muted" style="font-size:12px; margin-bottom:8px">
                  인쇄 설정: <strong>배율 100%</strong>, <strong>여백 없음</strong>
                </p>
                <button id="btn-print" class="btn btn-primary btn-lg" style="width:100%">🖨️ 인쇄하기</button>
              </div>
            </div>
          </div>

          <!-- 우측: A4 미리보기 -->
          <div class="preview-canvas">
            <div id="print-area" class="paper paper-a4"></div>
          </div>
        </div>
      </section>

    </main>
  </div>

  <!-- ========== 모달: 새 반 만들기 ========== -->
  <div id="modal-class" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <h2>새 반 만들기</h2>
        <button id="btn-modal-close" class="btn btn-ghost btn-icon">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">학년도</label>
            <input type="number" id="input-year" class="form-input" value="2026" min="2020" max="2030">
          </div>
          <div class="form-group">
            <label class="form-label">학기</label>
            <select id="input-term" class="form-select">
              <option value="1">1학기</option>
              <option value="2">2학기</option>
            </select>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">학년</label>
            <select id="input-grade" class="form-select">
              <option value="1">1학년</option>
              <option value="2">2학년</option>
              <option value="3">3학년</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">반</label>
            <input type="number" id="input-class-no" class="form-input" value="1" min="1" max="20">
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">담임 (선택)</label>
          <input type="text" id="input-teacher" class="form-input" placeholder="선생님 이름">
        </div>
      </div>
      <div class="modal-footer">
        <button id="btn-cancel-class" class="btn btn-secondary">취소</button>
        <button id="btn-save-class" class="btn btn-primary">저장</button>
      </div>
    </div>
  </div>

  <!-- ========== 모달: 안내 (데이터 부족 시) ========== -->
  <div id="modal-guide" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <h2 id="guide-title">안내</h2>
        <button id="btn-guide-close" class="btn btn-ghost btn-icon">&times;</button>
      </div>
      <div class="modal-body">
        <p id="guide-message"></p>
      </div>
      <div class="modal-footer">
        <button id="btn-guide-cancel" class="btn btn-ghost">취소</button>
        <button id="btn-guide-action" class="btn btn-primary">이동하기</button>
      </div>
    </div>
  </div>

  <!-- ========== 인쇄 전용 영역 ========== -->
  <div id="print-output" class="print-only"></div>

  <script type="module" src="/src/main.js"></script>
</body>
</html>
